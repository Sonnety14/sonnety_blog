---
title: "高等数学学习笔记"
description: "一点思考。"
date: 2025-12-19T00:00:00+08:00
image: admath.png
math: true
license: 
hidden: false
comments: true
draft: false
categories:
    - math
tags:
    - 高等数学
    - 学习日志
---

## 基础概念：

### 邻域

* **邻域** 就是以某一点为中心，向两边张开一段距离所构成的区间。

在数学表达中，点 $x_0$ 的邻域通常记作 $U(x_0, \delta)$。

* 中心： $x_0$
* 半径： $\delta > 0$
* 定义式： { $x \mid |x - x_0| < \delta$ }
* 区间表示： $(x_0 - \delta, x_0 + \delta)$

### 去心领域

去心邻域记作： $\mathring{U}(x_0, \delta)$ 。 

* 区间表示： $(x_0 - \delta, x_0) \cup (x_0, x_0 + \delta)$ 。
* 数学表达： $0 < |x - x_0| < \delta$ （注意这里是大于0，意味着距离不能为0，即 $x \neq x_0$）。

### 极大值极小值

* 极大值：若函数 $f(x)$ 在 $x_{0}$ 附近的一个邻域 $D$ 内有定义，且对于 $D$ 中除了 $x_{0}$ 以外的所有点 $x$ ，都有 $f(x)<f(x_{0})$ ，则 $f(x_{0})$ 称为一个极大值。
* 极小值：若函数 $f(x)$ 在 $x_{0}$ 附近的一个邻域 $D$ 内有定义，且对于 $D$ 中除了 $x_{0}$ 以外的所有点 $x$ ，都有 $f(x)>f(x_{0})$ ，则 $f(x_{0})$ 称为一个极小值。

### 曲率与曲率半径

如果曲线方程是 $y = f(x)$ ：

$$K = \frac{|y''|}{(1 + y'^2)^{\frac{3}{2}}}$$

如果曲线方程是 

$$
\begin{cases} 
x = x(t) \\
y = y(t) 
\end{cases}
$$

曲率为:

$$K = \frac{|x'y'' - x''y'|}{(x'^2 + y'^2)^{\frac{3}{2}}}$$

曲率半径:

$$R = \frac{1}{K}$$

## 微分中值定理

### 费马引理

即 **可导函数的极值点，导数一定为 0。**

**但是**

* 导数为 $0$ ，不一定是极值点。
  * 反例： $y = x^3$ ，在 $x=0$ 处，导数 $y' = 3x^2$ ，代入 $0$ 得 $0$ ，但是 $x=0$ 并不是极值点（它是拐点）。
* 极值点，导数不一定为 $0$ 。
  * 反例： $y = |x|$（绝对值函数），在 $x=0$ 处是极小值点（尖底），但是 $x=0$ 处导数不存在。

#### 标准定义

设函数 $f(x)$ 满足以下三个条件：
1. 在点 $x_0$ 的某邻域 $U(x_0)$ 内有定义。
2. 在点 $x_0$ 处可导（即 $f'(x_0)$ 存在）。
3. 在点 $x_0$ 处取得极值（极大值或极小值）。

结论：

$$f'(x_0) = 0$$

通常我们将导数为 $0$ 的点称为驻点。费马引理告诉我们：

**可导函数的极值点一定是驻点**

#### 严谨证明

假设： $f(x)$ 在 $x_0$ 处取得极大值。

$$f'(x_0) = \lim_{\Delta x \to 0} \frac{f(x_0 + \Delta x) - f(x_0)}{\Delta x}$$

* 对于左极限
  * 分子： $f(x_0 + \Delta x) \le f(x_0)$ ，分子 $\le 0$ 。
  * 分母： $\Delta x < 0$ 。
  * 左导数 $f'_-(x_0) \ge 0$ 。
* 对于右极限
  *  $f(x_0 + \Delta x) \le f(x_0)$ ，分子 $\le 0$ 。
  *  分母：$\Delta x > 0$ 。
  *  右导数 $f'_+(x_0) \le 0$。
夹逼得出结论：

题目已知 $f(x)$ 在 $x_0$ 处 **可导**，这意味着 **左导数必须等于右导数** 。

$$\therefore f'(x_0) = 0$$

### 罗尔定理

$f(x)$ 同时满足三个条件时：

* 连续性：在闭区间 $[a, b]$ 上连续。
* 可导性：在开区间 $(a, b)$ 内可导。
* 端点相等： $f(a) = f(b)$ （起点和终点的高度一样）。

结论：在 $(a, b)$ 之间，至少存在一点 $\xi$ ，使得这一点的导数为 $0$：

$$f'(\xi) = 0$$

反例：

$y = |x|$ 在 $[-1, 1]$ 上。

* 满足 $f(-1) = f(1) = 1$ 。
* 满足连续。
* 它在 $x=0$ 处不可导（尖点）。
* 结果： 全程没有导数为 $0$ 的点。

#### 直观理解

向空中抛出一个球，在同一高度接住球，那么在空中的某一个瞬间（最高点），球瞬时速度为 $0$ 。

在函数图像上，这意味着曲线必定有一个最高点（或最低点），在那里的切线是水平的。

#### 严谨证明

1. 因为 $f(x)$ 在闭区间 $[a, b]$ 上连续，它一定能在区间上取得最大值 $M$ 和最小值 $m$ 。
2. 分两种情况讨论：
   * 情况一： 如果 $M = m$ ，说明函数是一条水平直线（常数函数），那么导数处处为 $0$，结论显然成立。
   * 如果 $M > m$ ，因为已知 $f(a) = f(b)$ ，那么最大值 $M$ 和最小值 $m$ 中，至少有一个是不在端点的。
3. 费马引理：假设最大值取在内部某点 $\xi$。
   * $\xi$ 在区间内部 $\Rightarrow$ $\xi$ 处可导。
   * $\xi$ 是极值点。
   * 根据费马引理 $\Rightarrow$ $f'(\xi) = 0$ 。

#### 解题技巧

如：（条件使用）证明 $\exists \xi \in (a, b)$ ，使得 $f'(\xi) + f(\xi) = 0$ 。

逆向思维，构造一个辅助函数 $F(x)$，使得 $F'(x)$ 求导后正好是你要求的那个式子（这里指 $f'(x) + f(x)$ ）。

| 目标等式 (证明...) | 辅助函数构造法 ($F(x) = \dots$) | 原理 (求导验证) |
| :--- | :--- | :--- |
| $f'(\xi) = 0$ | $F(x) = f(x)$ | 原生罗尔定理 |
| $f'(\xi) + k = 0$ | $F(x) = f(x) + kx$ | $(f(x) + kx)' = f'(x) + k$ |
| $f'(\xi) + f(\xi) = 0$ | $F(x) = e^x f(x)$ | $(e^x f)' = e^x(f' + f)$ |
| $f'(\xi) - f(\xi) = 0$ | $F(x) = e^{-x} f(x)$ | $(e^{-x} f)' = e^{-x}(f' - f)$ |
| $xf'(\xi) + f(\xi) = 0$ | $F(x) = x f(x)$ | $(xf)' = xf' + f$ |
| $xf'(\xi) - f(\xi) = 0$ | $F(x) = \frac{f(x)}{x}$ | $(\frac{f}{x})' = \frac{xf' - f}{x^2}$ |

### 拉格朗日中值定理

* 同罗尔定理，**连续且可导**。
* 曲线有两个端点 $A(a, f(a))$ 和 $B(b, f(b))$。
* 连接 $AB$ 画一条直线（叫割线或弦）。
* 定理断言： 在 $A$ 和 $B$ 之间的曲线上，至少能找到一点 $\xi$，使得点 $\xi$ 处的切线与 $AB$ 连线平行。

即

$$\exists \xi \in (a,b),\frac{f(b) - f(a)}{b - a} = f'(\xi)$$

#### 直观理解

这个定理最经典的物理比喻就是 **“平均速度 vs 瞬时速度”**。

开车从成都去重庆，全程 $300$ 公里，你开了 $3$ 小时。平均速度 = $\frac{300}{3} = 100$ km/h。

拉格朗日中值定理：在这一路上的某一个瞬间，你车上的速度表指针一定准确地指在 $100$ km/h 这个刻度上。

* 如果你全程都低于 $100$ ，平均速度不可能到 $100$ 。
* 如果你全程都高于 $100$，平均速度肯定超过 $100$ 。
* 所以，要想平均速度是 $100$ ，中间必然经过 $100$ 那个点。

#### 严谨证明

辅助函数 $F(x) = f(x) - \frac{f(b)-f(a)}{b-a}(x-a)$ 。

（减去割线）

那么端点值为 $0$ ，罗尔定理，存在 $\xi$，使得 $F'(\xi)=f'(\xi)-\frac{f(b)-f(a)}{b-a}=0$。

证毕。

#### 解题技巧

1. 双中值问题

技巧：**看到两个中值 $\xi, \eta$ $\to$ 找到中间点 $c$ (通常是中点，或者是题目给的某个点) $\to$ 左右两边分别列出拉格朗日公式 $\to$ 通过加减乘除把中间点 $f(c)$ 消掉。**

（简化模型题目）

设 $f(x)$ 在 $[a, b]$ 上连续，在 $(a, b)$ 内可导，且 $f(a) = f(b) = 0$。证明：存在 $\xi \in (a, \frac{a+b}{2})$ ， $\eta \in (\frac{a+b}{2}, b)$ ，使得

$$f'(\xi) + f'(\eta) = 0$$

* 找切分点：题目中出现了 $\xi$ 和 $\eta$ 分别在两个子区间，分界点显然是中点 $c = \frac{a+b}{2}$。
* 左边用一次拉格朗日：在区间 $[a, c]$ 上应用定理： $$f(c) - f(a) = f'(\xi)(c - a)$$
  * 因为 $c-a = \frac{b-a}{2}$，且 $f(a)=0$，所以：
    $$f(c) = f'(\xi) \cdot \frac{b-a}{2} \quad \text{......(式1)}$$
* 右边用一次拉格朗日：在区间 $[c, b]$ 上应用定理： $$f(b) - f(c) = f'(\eta)(b - c)$$
  * 因为 $b-c = \frac{b-a}{2}$，且 $f(b)=0$，所以：
    $$-f(c) = f'(\eta) \cdot \frac{b-a}{2} \quad \text{......(式2)}$$
* 联立消元：我们要证 $f'(\xi) + f'(\eta) = 0$，观察 (式1) 和 (式2)。
  * 将两式相加：

$$f(c) + (-f(c)) = [f'(\xi) + f'(\eta)] \cdot \frac{b-a}{2}$$

$$0 = [f'(\xi) + f'(\eta)] \cdot \frac{b-a}{2}$$

由于 $\frac{b-a}{2} \neq 0$，所以必有：

$$f'(\xi) + f'(\eta) = 0$$

2. 证明不等式

证明：
当 $a > b > 0$ 时，

$$\sin a - \sin b < a - b$$

* 设 $f(x) = \sin x$，区间为 $[b, a]$ 。
* 根据定理，存在 $\xi \in (b, a)$ ，使得： $\sin a - \sin b = f'(\xi) (a - b)$ 。
  * 因为 $f(x) = \sin x$ ，所以 $f'(\xi) = \cos \xi$ 。
  * 即： $\sin a - \sin b = \cos \xi \cdot (a - b)$
* 放缩： $\cos \xi \le 1$ 。

### 柯西中值定理

设函数 $f(x)$ 和 $g(x)$ 满足：
1. 在闭区间 $[a, b]$ 上连续。
2. 在开区间 $(a, b)$ 内可导。
3. 在 $(a, b)$ 内， $g'(x) \neq 0$  （分母不能为0）。

结论：在 $(a, b)$ 内至少存在一点 $\xi$ (xi) ，使得：

$$\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(\xi)}{g'(\xi)}$$

#### 直观理解

把柯西定理看作是在一个二维平面上的运动轨迹。

* 把 $x$ 当作时间参数 $t$。
* 一个质点在平面上运动，坐标方程是

$$
\begin{cases} 
X = g(t) 
\\ 
Y = f(t) 
\end{cases}
$$

* $t$ 从 $a$ 走到 $b$ ，质点就从点 $A(g(a), f(a))$ 移动到了点 $B(g(b), f(b))$ 。

* 左边 $\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{\Delta Y}{\Delta X}$ ：这是连接起点 A 和终点 B 的弦的斜率。
* 右边 $\frac{f'(\xi)}{g'(\xi)} = \frac{dY/dt}{dX/dt} = \frac{dY}{dX}$ ：这是在时刻 $\xi$ 时，轨迹曲线上切线的瞬时斜率。

结论：总有一个瞬间，你运动轨迹的瞬时方向（切线）和起点终点的连线方向（弦）是平行的。

#### 严谨证明

我们想证 $\frac{f(b) - f(a)}{g(b) - g(a)} = \frac{f'(\xi)}{g'(\xi)}$ 。

移项变形：

$$[f(b) - f(a)]g'(\xi) - [g(b) - g(a)]f'(\xi) = 0$$

把 $\xi$ 换成 $x$ ，把导数换回原函数，我们构造出辅助函数：

$$F(x) = [f(b) - f(a)]g(x) - [g(b) - g(a)]f(x)$$

代入端点验证 $F(a)$ 和 $F(b)$ ：

* $F(a) = f(b)g(a) - f(a)g(a) - g(b)f(a) + g(a)f(a) = f(b)g(a) - g(b)f(a)$
* $F(b) = f(b)g(b) - f(a)g(b) - g(b)f(b) + g(a)f(b) = -f(a)g(b) + g(a)f(b)$
* $F(a) = F(b)$

根据罗尔定理， $\exists \xi, F'(\xi) = 0$。

$$[f(b) - f(a)]g'(\xi) - [g(b) - g(a)]f'(\xi) = 0$$

证毕。

#### 0/0型洛必达法则

在求 $\frac{0}{0}$ 型极限时:

$$\lim_{x \to a} \frac{f(x)}{g(x)} = \lim_{x \to a} \frac{f(x) - f(a)}{g(x) - g(a)} \quad (\text{设} f(a)=g(a)=0)$$

利用柯西中值定理：

$$= \lim_{\xi \to a} \frac{f'(\xi)}{g'(\xi)}$$

当 $x \to a$ 时，夹在中间的 $\xi$ 也只能 $\to a$。这就变成了 $\frac{f'(a)}{g'(a)}$ 。

这就是洛必达法则的原理。

## 泰勒展开

假设 $f(x)$ 能写成多项式（以 $x=0$ 为例，即麦克劳林公式）：

$$f(x) = a_0 + a_1 x + a_2 x^2 + a_3 x^3 + \dots$$

我们要确定系数 $a_0, a_1, a_2 \dots$ 是多少。
* 求 $a_0$ ：代入 $x=0$，得 $f(0) = a_0$ 。
* 求 $a_1$ ：两边求导 $\to f'(x) = a_1 + 2a_2 x + 3a_3 x^2 \dots$，代入 $x=0$，得 $f'(0) = a_1$ 。
* 求 $a_2$ ：再求导 $\to f''(x) = 2 \cdot 1 \cdot a_2 + 3 \cdot 2 \cdot a_3 x \dots$，代入 $x=0$，得 $f''(0) = 2! a_2 \Rightarrow a_2 = \frac{f''(0)}{2!}$。
* 求 $a_3$ ：再求导 $\to f'''(0) = 3! a_3 \Rightarrow a_3 = \frac{f'''(0)}{3!}$ 。

结论： 第 $n$ 项的系数就是 $\frac{f^{(n)}(0)}{n!}$。

于是得到了麦克劳林公式（在 $x=0$ 处的泰勒公式）：

$$f(x) = f(0) + f'(0)x + \frac{f''(0)}{2!}x^2 + \dots + \frac{f^{(n)}(0)}{n!}x^n + R_n(x)$$

<img width="536" height="326" alt="image" src="https://github.com/user-attachments/assets/17a8a3ad-3086-4e86-a41c-0d45ccefdc75" />

### 求极限题目

 **解题技巧:“上下同阶”。分母是 $x$ 的几次方，分子就展开到几次方。**

例题 $1$ ：
 
求 $\lim_{x \to 0} \frac{\sin x - x \cos x}{x^3}$

思路：

* 分母是 $3$ 次方，所以分子展开到 $3$ 次方。
* $\sin x \approx x - \frac{x^3}{6}$
* $x \cos x \approx x(1 - \frac{x^2}{2}) = x - \frac{x^3}{2}$
* 分子 $= (x - \frac{x^3}{6}) - (x - \frac{x^3}{2}) = \frac{1}{3}x^3$
* 极限 $= \frac{1}{3}$ 。

例题 $2$ ：
 
$$\lim_{x \to 0} \frac{\ln(1+x)\ln(1-x) + x^2}{x^4}$$

* 分母是 $4$ 次方，所以分子展开到 $4$ 次方。
* $\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} + o(x^3)$
* $\ln(1-x) = (-x) - \frac{(-x)^2}{2} + \frac{(-x)^3}{3} +o(x^3)$
* 为什么只展开到 $x^3$ 项?因为相乘之后幂次大于 $x^4$ 的全部统称为 $o(x^4)$
* $\ln(1+x)\ln(1-x) = -x^2 - \frac{5}{12}x^4 + o(x^4)$
* $\text{原式} = \lim_{x \to 0} \frac{\left[ -x^2 - \frac{5}{12}x^4 + o(x^4) \right] + x^2}{x^4}$
* $= \lim_{x \to 0} \frac{-\frac{5}{12}x^4 + o(x^4)}{x^4}$
* $= \mathbf{-\frac{5}{12}}$

### 求高阶导数

例题:

$f(x) = x^2 \ln(1+x)$ 求 $x=0$ 的 $n$ 阶导数.

* $\ln(1+x)$ 的经典展开式：
$$\ln(1+x) = x - \frac{x^2}{2} + \frac{x^3}{3} - \dots + \frac{(-1)^{k-1}}{k}x^k + \dots$$
* 将上面的展开式乘以 $x^2$ :
$$f(x) = x^3 - \frac{x^4}{2} + \frac{x^5}{3} - \dots + \mathbf{\frac{(-1)^{k-1}}{k}x^{k+2}} + \dots$$
* 令 $k = n - 2$
  * $x^n$ 这一项是： $\frac{(-1)^{n-3}}{n-2} x^n$

### 用泰勒公式做证明题

例题 $1$ ,板子题:

设 $f(x)$ 在 $[0,1]$ 上二阶可导，且 $f(0)=1$， $f'(0)=0$ ， $f''(x) \le 2$ ，求证：

$$f(x) \le 2 \quad (\text{或写作 } \max_{x \in [0,1]} f(x) \le 2)$$

* 我们在 $x_0 = 0$ 处将 $f(x)$ 展开到 $n=1$ 阶：

$$f(x) = f(0) + f'(0)(x-0) + \frac{f''(\xi)}{2!}(x-0)^2$$

其中 $\xi$ 介于 $0$ 和 $x$ 之间（即 $0 < \xi < x$ ）。
* 将题目给出的 $f(0)=1, f'(0)=0$ 代入上式

$$f(x) = 1 + \frac{1}{2}f''(\xi)x^2$$

* 利用不等式进行放缩
  * 题目已知对于区间内任意 $x$，都有 $f''(x) \le 2$。因为 $\xi$ 也在 $[0, 1]$ 区间内，所以必然满足： $\mathbf{f''(\xi) \le 2}$
  * $x \in [0, 1]$。所以 $x$ 的最大值是 1，即： $\mathbf{x^2 \le 1}$

证毕.

例题 $2$ ,选最大值点展开:


设 $f(x)$ 在 $[0,1]$ 上二阶可导，且 $f(0)=f(1)=0$ ， $\max_{0 \le x \le 1} f(x) = 2$ 。

证明：存在 $\xi \in (0,1)$ ，使得 $f''(\xi) \le -16$ 。

* 已知条件：端点 $f(0)=0, f(1)=0$ ,区间最大值为 $2$ 。
  * 设 设 $x=c$ ($0 < c < 1$) 是那个最大值点， $f(c) = 2$ ,根据费马引理, $f'(c) = 0$ 。

$$f(x) = f(c) + f'(c)(x-c) + \frac{f''(\xi)}{2!}(x-c)^2$$

* $x=0$ 时:

$$f(0) = f(c) + f'(c)(0-c) + \frac{f''(\xi_1)}{2}(0-c)^2$$

代入数据 ( $f(0)=0, f(c)=2, f'(c)=0$ )：

$$0 = 2 + 0 + \frac{f''(\xi_1)}{2}c^2$$

* $x=1$ 时:

$$f(1) = f(c) + f'(c)(1-c) + \frac{f''(\xi_2)}{2}(1-c)^2$$

代入数据 ( $f(1)=0, f(c)=2, f'(c)=0$ )：

$$0 = 2 + 0 + \frac{f''(\xi_2)}{2}(1-c)^2$$

* 现在我们有了两个 $\xi$ ： $f''(\xi_1) = -\frac{4}{c^2}$ 和 $f''(\xi_2) = -\frac{4}{(1-c)^2}$ ,我们要证明这两个里至少有一个小于等于 $-16$ 。
  * 要让 $-\frac{4}{c^2} \le -16$ ，就得 $\frac{1}{c^2} \ge 4 \Rightarrow c^2 \le \frac{1}{4} \Rightarrow c \le \frac{1}{2}$。
  * 要让 $-\frac{4}{(1-c)^2} \le -16$ ，就得 $(1-c)^2 \le \frac{1}{4} \Rightarrow 1-c \le \frac{1}{2} \Rightarrow c \ge \frac{1}{2}$。

无论 $c$ 在哪， $\xi_1$ 和 $\xi_2$ 中总有一个满足条件。

所以， $\exists \xi \in \{\xi_1, \xi_2\} \subset (0,1)$ ，使得 $f''(\xi) \le -16$。

例题 $3$ ,区间估计,任意点展开:

泰勒公式 $f(x_0+\Delta x) = f(x_0) + f'(x_0)\Delta x + \dots$。

设 $f(x)$ 在 $[0,1]$ 上二阶可导，且 $|f(x)| \le a$， $|f''(x)| \le b$，其中 $a,b$ 都是非负常数。证明：

$$|f'(x)| \le 2a + \frac{b}{2}, \quad \forall x \in (0,1)$$

我们需要利用区间 $[0,1]$ 的两个端点 $0$ 和 $1$。我们在任意点 $x$ 处展开，分别去够这两个端点：

1. 向右展到 $1$ ：把 $1$ 看作 $x + (1-x)$ 。

$$f(1) = f(x) + f'(x)(1-x) + \frac{f''(\xi_1)}{2}(1-x)^2$$

其中 $x < \xi_1 < 1$ 。

2. 向左展到 $0$ ：把 $0$ 看作 $x + (0-x)$ 。

$$f(0) = f(x) + f'(x)(0-x) + \frac{f''(\xi_2)}{2}(0-x)^2$$

其中 $0 < \xi_2 < x$。

如果我们把式 ① 减去式 ② ：

$$f(1) - f(0) = 0 + f'(x)[1] + \frac{f''(\xi_1)}{2}(1-x)^2 - \frac{f''(\xi_2)}{2}x^2$$

移项整理，得到 $f'(x)$ 的表达式：

$$f'(x) = f(1) - f(0) - \frac{f''(\xi_1)}{2}(1-x)^2 + \frac{f''(\xi_2)}{2}x^2$$

两边取绝对值，利用 $|A+B| \le |A|+|B|$ ：

$$|f'(x)| \le |f(1)| + |-f(0)| + \left| -\frac{f''(\xi_1)}{2}(1-x)^2 \right| + \left| \frac{f''(\xi_2)}{2}x^2 \right|$$

代入题目给的界限 $|f(x)| \le a$ 和 $|f''(x)| \le b$ ：

* $|f(1)| \le a$
* $|f(0)| \le a$
* $|f''(\xi_1)| \le b$
* $|f''(\xi_2)| \le b$

$$|f'(x)| \le 2a + \frac{b}{2} \left[ (1-x)^2 + x^2 \right]$$

现在我们需要确定 $\left[ (1-x)^2 + x^2 \right]$ 在 $x \in (0,1)$ 上的最大值。

省流: $(1-x)^2 + x^2 \le 1$ 。

$$|f'(x)| \le 2a + \frac{b}{2}$$

证毕.

## 不定积分

函数 $f(x)$ 的所有原函数的全体，称为 $f(x)$ 的不定积分，记作：

$$\int f(x) dx = F(x) + C$$

* $\int$ ：积分号（Integral Sign）。它其实是字母 S 的拉长.。
* $f(x)$ ：被积函数（Integrand）。就是那个求导后的结果。
* $dx$ ：积分变量。告诉你也是对谁积分（就像导数里的分母 $dx$ ）。
* $F(x)$ ：某一个原函数。
* $C$：积分常数（Arbitrary Constant）。**千万别漏了**,就是因为它，积分的结果才是不确定的，所以叫“不定”积分。

三角函数基本积分表:

* $\int \sin x dx = -\cos x + C$
* $\int \cos x dx = \sin x + C$
* $\int \sec^2 x dx = \tan x + C$
* $\int \sec x\ \tan x dx = \sec x + C$
* $\int \csc^2 x dx = -\cot x + C$

### 基本性质

* 导数和积分是互逆的

$$\left[ \int f(x) dx \right]' = f(x)$$

$$\int f'(x) dx = f(x) + C$$

* 线性性质
1. 系数可以提出来

$$\int k \cdot f(x) dx = k \int f(x) dx \quad (k \neq 0)$$

2. 加减可以分开算

$$\int [f(x) \pm g(x)] dx = \int f(x) dx \pm \int g(x) dx$$

### 换元积分法


### 分部积分法

本质上就是乘法求导法则的逆运算。

$$\int u \, dv = uv - \int v \, du$$

或者如下：

$$\int u(x) v'(x) \, dx = u(x)v(x) - \int v(x) u'(x) \, dx$$

设 $u(x)$ 和 $v(x)$ 是两个可导函数。根据乘法法则：

$$[u(x)v(x)]' = u'(x)v(x) + u(x)v'(x)$$

我们把这个等式移项，把我们要积分的那部分 $u(x)v'(x)$ 单独留在一边：

$$u(x)v'(x) = [u(x)v(x)]' - v(x)u'(x)$$

接下来，对等式两边同时求不定积分（对 $x$ 积分）：

$$\int u(x)v'(x) \, dx = \int [u(x)v(x)]' \, dx - \int v(x)u'(x) \, dx$$

即

$$\int u(x)v'(x) \, dx = u(x)v(x) - \int v(x)u'(x) \, dx$$

为了好记，我们通常把 $v'(x)dx$ 写成 $dv$ ，把 $u'(x)dx$ 写成 $du$ ，公式就变成了简短的：

$$\int u \, dv = uv - \int v \, du$$

面对 $\int f(x)g(x) dx$，谁当 $u$（求导），谁当 $dv$（积分）？
口诀：“反、对、幂、三、指”。

这个顺序是选取 $u$ 的优先级（排在前面的优先设为 $u$）：
1. 反：反三角函数 ($\arcsin x, \arctan x$)
2. 对：对数函数 ($\ln x$)
3. 幂：幂函数/多项式 ($x, x^2$)
4. 三：三角函数 ($\sin x, \cos x$)
5. 指：指数函数 ($e^x$)

#### 基础形

例 $1$ ： 

$$\int x \sin 2x \, dx$$

由口诀“幂 > 三”，选 $u=x$，$dv = \sin 2x dx$ 。

$$v = \int \sin 2x dx = -\frac{1}{2} \cos 2x$$

$$\text{原式} = -\frac{1}{2}x \cos 2x - \int (-\frac{1}{2} \cos 2x) dx$$

$$= -\frac{1}{2}x \cos 2x + \frac{1}{4} \sin 2x + C$$

例 $2$ ：

$$\int x \arcsin x \, dx$$

由口诀“反 > 幂”，选 $u = \arcsin x$ ， $dv = x dx \Rightarrow v = \frac{1}{2}x^2$ 。

$$\text{原式} = \frac{1}{2}x^2 \arcsin x - \int \frac{1}{2}x^2 \cdot \frac{1}{\sqrt{1-x^2}} dx$$

为了去掉分母里的根号 $\sqrt{1-x^2}$ ，我们令：

$$x = \sin t \quad (-\frac{\pi}{2} < t < \frac{\pi}{2})$$

$$dx = \cos t \, dt$$

$$\sqrt{1-x^2} = \sqrt{1-\sin^2 t} = \cos t$$

将 $x$ 和 $dx$ 换进去：

$$J = \int \frac{\sin^2 t}{\cos t} \cdot \cos t \, dt$$

$$\cos t \text{ 约分后：}$$

$$J = \int \sin^2 t \, dt$$

遇到偶次幂 $\sin^2 t$ ，使用倍角公式降次： $\sin^2 t = \frac{1 - \cos 2t}{2}$

$$J = \int \frac{1 - \cos 2t}{2} \, dt = \frac{1}{2} \int (1 - \cos 2t) \, dt$$

$$J = \frac{1}{2} \left( t - \frac{1}{2}\sin 2t \right)$$

为了方便回代，把 $\sin 2t$ 展开：

$$J = \frac{1}{2} t - \frac{1}{4}(2\sin t \cos t) = \frac{1}{2} t - \frac{1}{2}\sin t \cos t$$

所以积分 $J$ 的结果是：

$$J = \frac{1}{2} \arcsin x - \frac{1}{2} x \sqrt{1-x^2}$$

$$I = \frac{2x^2-1}{4} \arcsin x + \frac{1}{4} x \sqrt{1-x^2} + C$$

#### 隐形的 1

被积函数只有一个复杂的“反”或“对”函数，这时候把 $dv$ 看作 $1 \cdot dx$ 。

例： 

$$\int \arctan \sqrt{x} \, dx$$

令 $t = \sqrt{x} \Rightarrow x=t^2, dx=2tdt$ 。

原式变为 $\int \arctan t \cdot 2t dt$

#### 循环积分

积分两次后，又回到了原来的积分形式，然后通过移项解方程求解。

例： 

$$\int \sin(\ln x) \, dx$$

容易得到，前步骤省略：

$$I = x \sin(\ln x) - \int \cos(\ln x) \, dx$$

对后面剩下的 $\int \cos(\ln x) \, dx$ 再做一次分部积分，直到原来的积分 $I$ 再次出现，然后通过移项解方程求出结果。

* $J = \int \cos(\ln x) \, dx$
* $u = \cos(\ln x)$
* $du = -\sin(\ln x) \cdot \frac{1}{x} \, dx$
* $dv = dx$
* $v = x$

$$J = x \cos(\ln x) - \int x \cdot \left( -\frac{\sin(\ln x)}{x} \right) \, dx$$

$$J = x \cos(\ln x) + \int \sin(\ln x) \, dx$$

这里出现的 $\int \sin(\ln x) \, dx$ 正是我们一开始要求的原积分 $I$。

$$I = x \sin(\ln x) - \left[ x \cos(\ln x) + I \right]$$

#### 凑微分

不会。

$$\int x \frac{\cos x}{\sin^3 x} \, dx$$

* 这里 $x$ 是幂函数，$\frac{\cos x}{\sin^3 x}$ 是三角部分。
* 发现 $(\frac{-1}{2\sin^2 x})' = \frac{\cos x}{\sin^3 x}$。
* 所以设 $u=x$，$dv = \frac{\cos x}{\sin^3 x} dx$。

$$$\int \frac{x^2 e^x}{(x+2)^2} \, dx$$$
* 关键是把 $dv$ 设为 $\frac{1}{(x+2)^2} dx$（因为它积分是 $\frac{-1}{x+2}$），剩下的全是 $u$。
* 或者分子配凑：$x^2 = (x+2-2)^2$，拆开后再积。

## 定积分

定积分 $\int_a^b f(x) dx$ 代表的是曲线 $y=f(x)$、直线 $x=a, x=b$ 以及 $x$ 轴所围成的**曲边梯形的面积**。

定积分的本质是**极限**。将区间 $[a, b]$ 分成 $n$ 份，取每一份的高度 $f(\xi_i)$ 乘以宽度 $\Delta x_i$，然后求和取极限：

$$
\int_a^b f(x) dx = \lim_{\lambda \to 0} \sum_{i=1}^n f(\xi_i) \Delta x_i
$$

### 基本性质与基本公式

1.  **线性性质**：

$$\int_a^b [k f(x) + g(x)] dx = k \int_a^b f(x) dx + \int_a^b g(x) dx$$


2.  **区间可加性**：

$$\int_a^b f(x) dx = \int_a^c f(x) dx + \int_c^b f(x) dx$$

(无论 $c$ 在不在 $a, b$ 之间，只要函数可积，公式恒成立。这常用于**分段函数**和**去绝对值**的积分)

3.  **积分上下限互换**：

$$\int_a^b f(x) dx = - \int_b^a f(x) dx$$

4.  **估值定理**：

如果 $m \le f(x) \le M$，则：

$$m(b-a) \le \int_a^b f(x) dx \le M(b-a)$$

#### 变上限积分求导

**积分后的函数再求导，会变回原来的函数。**

1. 基础公式

如果 $\Phi(x) = \int_a^x f(t) dt$ ，那么：

$$\Phi'(x) = f(x)$$

直观理解： 把上限 $x$ 直接丢进去替换掉 $t$，积分号扔掉。

2. 链式法则

如果上限不是 $x$ 而是 $u(x)$ （比如 $x^2$ ），或者下限也是变量 $v(x)$ ，公式如下：

$$\frac{d}{dx} \int_{v(x)}^{u(x)} f(t) dt = f[u(x)] \cdot u'(x) - f[v(x)] \cdot v'(x)$$

例：

遇到 $\lim_{x \to 0} \frac{\int_0^x \dots}{x}$ 这种题，99% 是 0/0 型洛必达法则，分子就是变限积分求导。

* $\lim_{x \to 0} \frac{\int_0^x \cos t^2 dt}{x}$
* 分子求导： $\cos(x^2)$
* 分母求导：$1$
* 结果：$\cos(0) = 1$

#### 定积分是常数（解积分方程）

核心思想：定积分 $\int_a^b f(x) dx$ （ $a,b$ 是常数）算出来是一个具体的数字，而不是函数。

例：

设 $f(x) = x^2 - x \int_0^2 f(x) dx + 2 \int_0^1 f(x) dx$ 。

* 设常数：观察到 $\int_0^2 f(x) dx$ 和 $\int_0^1 f(x) dx$ 都是常数。
  * 设 $A = \int_0^2 f(x) dx$，设 $B = \int_0^1 f(x) dx$ 。
* 回代：原方程变为 $f(x) = x^2 - Ax + 2B$ 。
* 自洽计算：把这个 $f(x)$ 的表达式再代回积分里去算 $A$ 和 $B$ 。
* $A = \int_0^2 (x^2 - Ax + 2B) dx = [\frac{1}{3}x^3 - \frac{A}{2}x^2 + 2Bx]_0^2 = \frac{8}{3} - 2A + 4B$
* 同理算出 $B$ 的方程。联立方程组：解出 $A$ 和 $B$，最后写出 $f(x)$。

#### 分段函数与绝对值（牛顿-莱布尼茨公式的应用）

例：

$$I = \int_0^2 |1-x| \sqrt{(x-2)^2} dx$$

* 先化简：$\sqrt{(x-2)^2} = |x-2|$
* 在 $[0,2]$ 区间上，$x-2$ 恒为负，所以 $|x-2| = 2-x$
* 对于 $|1-x|$，以 $1$ 为界拆分：
  * $0 \le x \le 1$ 时，是 $(1-x)$
  * $1 < x \le 2$ 时，是 $(x-1)$
* 拆积分：$\int_0^1 (1-x)(2-x) dx + \int_1^2 (x-1)(2-x) dx$

#### 变限积分函数

例：

$\Phi(x) = \int_0^x f(t) dt$ ,分段函数 $f(t)$ ：在 $[0,1]$ 是 $t^2$ ，在 $[1,2]$ 是 $t$ ，求 $\Phi(x)$ 。

* 情况 1：$0 \le x \le 1$ ， $\Phi(x) = \int_0^x t^2 dt = \frac{1}{3}x^3$ 。

* 情况 2： $1 < x \le 2$
  * 积分是从 0 积到 $x$，必须要把前面那一段满的加上！
  * $\Phi(x) = \int_0^1 t^2 dt + \int_1^x t dt$
  * $\Phi(x) = \frac{1}{3} + [\frac{1}{2}t^2]_1^x = \frac{1}{3} + (\frac{1}{2}x^2 - \frac{1}{2})$
